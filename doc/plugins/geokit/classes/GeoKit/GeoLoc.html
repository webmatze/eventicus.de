<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: GeoKit::GeoLoc</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">GeoKit::GeoLoc</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/vendor/plugins/geokit/lib/geo_kit/mappable_rb.html">
                vendor/plugins/geokit/lib/geo_kit/mappable.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="LatLng.html">
                LatLng
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
This class encapsulates the result of a geocoding call It&#8216;s primary
purpose is to homogenize the results of multiple geocoding providers. It
also provides some additional functionality, such as the &quot;full
address&quot; method for geocoders that do not provide a full address in
their results (for example, Yahoo), and the &quot;is_us&quot; method.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000029">city=</a>&nbsp;&nbsp;
      <a href="#M000024">full_address</a>&nbsp;&nbsp;
      <a href="#M000027">hash</a>&nbsp;&nbsp;
      <a href="#M000023">is_us?</a>&nbsp;&nbsp;
      <a href="#M000022">new</a>&nbsp;&nbsp;
      <a href="#M000030">street_address=</a>&nbsp;&nbsp;
      <a href="#M000026">street_name</a>&nbsp;&nbsp;
      <a href="#M000025">street_number</a>&nbsp;&nbsp;
      <a href="#M000031">to_geocodeable_s</a>&nbsp;&nbsp;
      <a href="#M000028">to_hash</a>&nbsp;&nbsp;
      <a href="#M000032">to_s</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">city</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
Location attributes. Full address is a concatenation of all values. For
example: 100 Spear St, San Francisco, CA, 94101, US

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">country_code</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
Location attributes. Full address is a concatenation of all values. For
example: 100 Spear St, San Francisco, CA, 94101, US

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">full_address</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
Location attributes. Full address is a concatenation of all values. For
example: 100 Spear St, San Francisco, CA, 94101, US

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">precision</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
Attributes set upon return from geocoding. Success will be true for
successful geocode lookups. The provider will be set to the name of the
providing geocoder. Finally, precision is an indicator of the accuracy of
the geocoding.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">provider</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
Attributes set upon return from geocoding. Success will be true for
successful geocode lookups. The provider will be set to the name of the
providing geocoder. Finally, precision is an indicator of the accuracy of
the geocoding.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">state</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
Location attributes. Full address is a concatenation of all values. For
example: 100 Spear St, San Francisco, CA, 94101, US

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">street_address</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
Location attributes. Full address is a concatenation of all values. For
example: 100 Spear St, San Francisco, CA, 94101, US

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">street_name</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
Street number and street name are extracted from the street address
attribute.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">street_number</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
Street number and street name are extracted from the street address
attribute.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">success</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
Attributes set upon return from geocoding. Success will be true for
successful geocode lookups. The provider will be set to the name of the
providing geocoder. Finally, precision is an indicator of the accuracy of
the geocoding.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">zip</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
Location attributes. Full address is a concatenation of all values. For
example: 100 Spear St, San Francisco, CA, 94101, US

</td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000022" class="method-detail">
        <a name="M000022"></a>

        <div class="method-heading">
          <a href="#M000022" class="method-signature">
          <span class="method-name">new</span><span class="method-args">(h={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Constructor expects a <a href="GeoLoc.html#M000027">hash</a> of symbols to
correspond with attributes.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000022-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000022-source">
<pre>
     <span class="ruby-comment cmt"># File vendor/plugins/geokit/lib/geo_kit/mappable.rb, line 283</span>
283:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">h</span>={})
284:       <span class="ruby-ivar">@street_address</span>=<span class="ruby-identifier">h</span>[<span class="ruby-identifier">:street_address</span>] 
285:       <span class="ruby-ivar">@city</span>=<span class="ruby-identifier">h</span>[<span class="ruby-identifier">:city</span>] 
286:       <span class="ruby-ivar">@state</span>=<span class="ruby-identifier">h</span>[<span class="ruby-identifier">:state</span>] 
287:       <span class="ruby-ivar">@zip</span>=<span class="ruby-identifier">h</span>[<span class="ruby-identifier">:zip</span>] 
288:       <span class="ruby-ivar">@country_code</span>=<span class="ruby-identifier">h</span>[<span class="ruby-identifier">:country_code</span>] 
289:       <span class="ruby-ivar">@success</span>=<span class="ruby-keyword kw">false</span>
290:       <span class="ruby-ivar">@precision</span>=<span class="ruby-value str">'unknown'</span>
291:       <span class="ruby-keyword kw">super</span>(<span class="ruby-identifier">h</span>[<span class="ruby-identifier">:lat</span>],<span class="ruby-identifier">h</span>[<span class="ruby-identifier">:lng</span>])
292:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000029" class="method-detail">
        <a name="M000029"></a>

        <div class="method-heading">
          <a href="#M000029" class="method-signature">
          <span class="method-name">city=</span><span class="method-args">(city)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets the city after capitalizing each word within the city name.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000029-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000029-source">
<pre>
     <span class="ruby-comment cmt"># File vendor/plugins/geokit/lib/geo_kit/mappable.rb, line 326</span>
326:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">city=</span>(<span class="ruby-identifier">city</span>)
327:       <span class="ruby-ivar">@city</span> = <span class="ruby-identifier">city</span>.<span class="ruby-identifier">titleize</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">city</span>
328:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000024" class="method-detail">
        <a name="M000024"></a>

        <div class="method-heading">
          <a href="#M000024" class="method-signature">
          <span class="method-name">full_address</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="GeoLoc.html#M000024">full_address</a> is provided by google but
not by yahoo. It is intended that the google geocoding method will provide
the full address, whereas for yahoo it will be derived from the parts of
the address we do have.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000024-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000024-source">
<pre>
     <span class="ruby-comment cmt"># File vendor/plugins/geokit/lib/geo_kit/mappable.rb, line 302</span>
302:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">full_address</span>
303:       <span class="ruby-ivar">@full_address</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@full_address</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">to_geocodeable_s</span>
304:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000027" class="method-detail">
        <a name="M000027"></a>

        <div class="method-heading">
          <a href="#M000027" class="method-signature">
          <span class="method-name">hash</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
gives you all the important fields as key-value pairs
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000027-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000027-source">
<pre>
     <span class="ruby-comment cmt"># File vendor/plugins/geokit/lib/geo_kit/mappable.rb, line 318</span>
318:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">hash</span>
319:       <span class="ruby-identifier">res</span>={}
320:       [<span class="ruby-identifier">:success</span>,<span class="ruby-identifier">:lat</span>,<span class="ruby-identifier">:lng</span>,<span class="ruby-identifier">:country_code</span>,<span class="ruby-identifier">:city</span>,<span class="ruby-identifier">:state</span>,<span class="ruby-identifier">:zip</span>,<span class="ruby-identifier">:street_address</span>,<span class="ruby-identifier">:provider</span>,<span class="ruby-identifier">:full_address</span>,<span class="ruby-identifier">:is_us?</span>,<span class="ruby-identifier">:ll</span>,<span class="ruby-identifier">:precision</span>].<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span> <span class="ruby-identifier">res</span>[<span class="ruby-identifier">s</span>] = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">s</span>.<span class="ruby-identifier">to_s</span>) }
321:       <span class="ruby-identifier">res</span>
322:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000023" class="method-detail">
        <a name="M000023"></a>

        <div class="method-heading">
          <a href="#M000023" class="method-signature">
          <span class="method-name">is_us?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns true if geocoded to the United States.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000023-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000023-source">
<pre>
     <span class="ruby-comment cmt"># File vendor/plugins/geokit/lib/geo_kit/mappable.rb, line 295</span>
295:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">is_us?</span>
296:       <span class="ruby-identifier">country_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'US'</span>
297:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000030" class="method-detail">
        <a name="M000030"></a>

        <div class="method-heading">
          <a href="#M000030" class="method-signature">
          <span class="method-name">street_address=</span><span class="method-args">(address)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets the street address after capitalizing each word within the street
address.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000030-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000030-source">
<pre>
     <span class="ruby-comment cmt"># File vendor/plugins/geokit/lib/geo_kit/mappable.rb, line 331</span>
331:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">street_address=</span>(<span class="ruby-identifier">address</span>)
332:       <span class="ruby-ivar">@street_address</span> = <span class="ruby-identifier">address</span>.<span class="ruby-identifier">titleize</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">address</span>
333:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000026" class="method-detail">
        <a name="M000026"></a>

        <div class="method-heading">
          <a href="#M000026" class="method-signature">
          <span class="method-name">street_name</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the street name portion of the street address.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000026-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000026-source">
<pre>
     <span class="ruby-comment cmt"># File vendor/plugins/geokit/lib/geo_kit/mappable.rb, line 313</span>
313:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">street_name</span>
314:        <span class="ruby-identifier">street_address</span>[<span class="ruby-identifier">street_number</span>.<span class="ruby-identifier">length</span>, <span class="ruby-identifier">street_address</span>.<span class="ruby-identifier">length</span>].<span class="ruby-identifier">strip</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">street_address</span>
315:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000025" class="method-detail">
        <a name="M000025"></a>

        <div class="method-heading">
          <a href="#M000025" class="method-signature">
          <span class="method-name">street_number</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Extracts the street number from the street address if the street address
has a value.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000025-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000025-source">
<pre>
     <span class="ruby-comment cmt"># File vendor/plugins/geokit/lib/geo_kit/mappable.rb, line 308</span>
308:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">street_number</span>
309:       <span class="ruby-identifier">street_address</span>[<span class="ruby-regexp re">/(\d*)/</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">street_address</span>
310:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000031" class="method-detail">
        <a name="M000031"></a>

        <div class="method-heading">
          <a href="#M000031" class="method-signature">
          <span class="method-name">to_geocodeable_s</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a comma-delimited string consisting of the street address, city,
state, zip, and country code. Only includes those attributes that are
non-blank.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000031-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000031-source">
<pre>
     <span class="ruby-comment cmt"># File vendor/plugins/geokit/lib/geo_kit/mappable.rb, line 337</span>
337:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_geocodeable_s</span>
338:       <span class="ruby-identifier">a</span>=[<span class="ruby-identifier">street_address</span>, <span class="ruby-identifier">city</span>, <span class="ruby-identifier">state</span>, <span class="ruby-identifier">zip</span>, <span class="ruby-identifier">country_code</span>].<span class="ruby-identifier">compact</span>
339:       <span class="ruby-identifier">a</span>.<span class="ruby-identifier">delete_if</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-identifier">e</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">e</span> <span class="ruby-operator">==</span> <span class="ruby-value str">''</span> }
340:       <span class="ruby-identifier">a</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">', '</span>)      
341:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000028" class="method-detail">
        <a name="M000028"></a>

        <div class="method-heading">
          <span class="method-name">to_hash</span><span class="method-args">()</span>
        </div>
      
        <div class="method-description">
          <p>
Alias for <a href="GeoLoc.html#M000027">hash</a>
</p>
        </div>
      </div>

      <div id="method-M000032" class="method-detail">
        <a name="M000032"></a>

        <div class="method-heading">
          <a href="#M000032" class="method-signature">
          <span class="method-name">to_s</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a string representation of the instance.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000032-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000032-source">
<pre>
     <span class="ruby-comment cmt"># File vendor/plugins/geokit/lib/geo_kit/mappable.rb, line 344</span>
344:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_s</span>
345:       <span class="ruby-node">&quot;Provider: #{provider}\n Street: #{street_address}\nCity: #{city}\nState: #{state}\nZip: #{zip}\nLatitude: #{lat}\nLongitude: #{lng}\nCountry: #{country_code}\nSuccess: #{success}&quot;</span>
346:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>